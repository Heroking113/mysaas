(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[2],{305:function(t,e,s){"use strict";s.r(e);var a=s(321);var i=s(309);for(var n in i)if(n!=="default")(function(t){s.d(e,t,function(){return i[t]})})(n);var l=s(318);var r=s(12);var c=Object(r["a"])(i["default"],a["a"],a["b"],false,null,"20d81182",null);e["default"]=c.exports},309:function(t,e,s){"use strict";s.r(e);var a=s(310);var i=s.n(a);for(var n in a)if(n!=="default")(function(t){s.d(e,t,function(){return a[t]})})(n);e["default"]=i.a},310:function(t,e,s){"use strict";var a=s(2);Object.defineProperty(e,"__esModule",{value:true});e.default=void 0;var i=a(s(98));var n=a(s(99));var l={components:{},data:function t(){return{HostData:[],BusinessData:[],bk_biz_id:"",MissionData:[],content:"",selected_bk_biz_id:"",selected_script_content:"",selected_hosts:[]}},created:function t(){var e=this;this.$http.get("/query_all_info/").then(function(t){if(t.data.result){var s=t.data.data;if(s.host_data){e.HostData=s.host_data}if(s.business_data){e.BusinessData=s.business_data}e.MissionData=s.mission_data;e.BusinessData.unshift({bk_biz_id:0,bk_biz_name:"所有任务"})}else{e.$message.error("获取信息失败！")}})},mounted:function t(){(0,i.default)("#execute").click(function(){(0,i.default)("#execute").css("background","#008272")})},methods:{onSubmit:function t(){var e=this;var s={};if(this.selected_bk_biz_id!==""){s["bk_biz_id"]=this.selected_bk_biz_id;s["business_name"]=(0,i.default)("#cur_business").val()}else{this.$message.warning("请选择业务");return}if(this.selected_script_content!==""){s["script_content"]=this.selected_script_content;s["mission_name"]=(0,i.default)("#cur_mission").val()}else{this.$message.warning("请选择任务");return}if(this.selected_hosts.length>0){var a=[];this.selected_hosts.forEach(function(t){a.push({bk_cloud_id:t.bk_cloud_id,ip:t.bk_host_innerip,machine_num:t.machine_num})});s["host_list"]=JSON.stringify(a)}else{this.$message.warning("请至少选择一台主机");return}this.$http.post("/execute_script/",n.default.stringify(s)).then(function(t){if(t.data.result){if(t.data.message==="success"){e.$message.success("任务执行成功")}else if(t.data.message==="doing"){e.$message.warning("任务正在执行，请勿重复提交")}else{e.$message.error("任务执行失败")}}else{e.$message.error("任务提交失败")}})},goRecord:function t(){this.$router.push({path:window.PROJECT_CONFIG.SITE_URL+"task-record"})},get_select_business_label:function t(e){var s=this;this.selected_bk_biz_id=e;var a="/retrieve_host/?bk_biz_id="+this.selected_bk_biz_id;this.$http.get(a).then(function(t){if(t.data.result){s.HostData=t.data.data}else{s.$message.error("获取当前业务下的主机信息失败！")}})},get_select_script_content:function t(e){this.selected_script_content=e},handleSelectionChange:function t(e){this.selected_hosts=e}}};e.default=l},311:function(t,e,s){},318:function(t,e,s){"use strict";var a=s(311);var i=s.n(a);var n=i.a},321:function(t,e,s){"use strict";var a=function(){var t=this;var e=t.$createElement;var s=t._self._c||e;return s("div",[s("el-container",[s("el-header",{staticClass:"head-left-content"},[s("el-button",{staticClass:"navibar-button-style",staticStyle:{"background-color":"#0a6659"},attrs:{id:"execute",type:"primary"}},[t._v("执行任务")]),t._v(" "),s("el-button",{staticClass:"navibar-button-style",attrs:{type:"primary"},on:{click:t.goRecord}},[t._v("任务记录")])],1)],1),t._v(" "),s("div",{staticClass:"table-style"},[s("el-form",{staticClass:"demo-form-inline",attrs:{inline:true}},[s("el-form-item",{attrs:{label:"选择业务"}},[s("el-select",{ref:"select_business",staticStyle:{width:"160px"},attrs:{id:"cur_business",placeholder:"请选择"},on:{change:t.get_select_business_label},model:{value:t.bk_biz_id,callback:function(e){t.bk_biz_id=e},expression:"bk_biz_id"}},t._l(t.BusinessData,function(t){return s("el-option",{key:t.bk_biz_id,attrs:{label:t.bk_biz_name,value:t.bk_biz_id}})}),1)],1),t._v(" "),s("el-form-item",{attrs:{label:"选择任务"}},[s("el-select",{ref:"select_script",staticStyle:{width:"280px"},attrs:{id:"cur_mission",placeholder:"请选择"},on:{change:t.get_select_script_content},model:{value:t.content,callback:function(e){t.content=e},expression:"content"}},t._l(t.MissionData,function(t){return s("el-option",{key:t.mission_content,attrs:{label:t.mission_name,value:t.mission_content}})}),1)],1),t._v(" "),s("el-form-item",[s("el-button",{attrs:{type:"primary"},on:{click:t.onSubmit}},[t._v("执行")])],1)],1),t._v(" "),s("hr",{staticStyle:{FILTER:"alpha(opacity=100,finishopacity=0,style=3)"},attrs:{width:"100%",color:"gray",size:"1"}}),t._v(" "),s("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{border:"",data:t.HostData,"tooltip-effect":"dark"},on:{"selection-change":t.handleSelectionChange}},[s("el-table-column",{attrs:{align:"center",type:"selection",width:"55"}}),t._v(" "),s("el-table-column",{attrs:{align:"center",prop:"bk_cloud_id",label:"云区域ID",width:"100"}}),t._v(" "),s("el-table-column",{attrs:{align:"center",prop:"bk_cpu",label:"核数",width:"100"}}),t._v(" "),s("el-table-column",{attrs:{align:"center",prop:"bk_os_name",label:"操作系统",width:"150"}}),t._v(" "),s("el-table-column",{attrs:{align:"center",prop:"bk_host_innerip",label:"内网IP",width:"150"}}),t._v(" "),s("el-table-column",{attrs:{align:"center",prop:"bk_host_id",label:"主机ID",width:"150"}}),t._v(" "),s("el-table-column",{attrs:{align:"center",prop:"bk_os_bit",label:"位数",width:"150"}}),t._v(" "),s("el-table-column",{attrs:{align:"center",prop:"create_time",label:"创建时间",width:"300"}}),t._v(" "),s("el-table-column",{attrs:{align:"center",fixed:"right",label:"操作",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("el-button",{attrs:{type:"text",size:"small"},nativeOn:{click:function(s){s.preventDefault();t.deleteRow(e.$index,t.tableData)}}},[t._v("待定")])]}}])})],1)],1)],1)};var i=[];s.d(e,"a",function(){return a});s.d(e,"b",function(){return i})}}]);